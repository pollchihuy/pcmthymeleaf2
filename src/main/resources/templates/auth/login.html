<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link rel="stylesheet" th:href="@{/css/login.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/error.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/4.6.2/css/bootstrap.min.css}" type="text/css"/>
    <title>Document</title>
</head>
<body>

<div class="wrapper">
    <div class="logo">
        <img src="https://www.freepnglogos.com/uploads/twitter-logo-png/twitter-bird-symbols-png-logo-0.png" alt="">
    </div>
    <div class="text-center mt-4 name">
        Twitter
    </div>
    <form id="form-login" class="p-3 mt-3" method="POST" th:object="${x}" th:action="@{/auth/login}">
        <div class="form-field d-flex align-items-center">
            <span class="far fa-user"></span>
            <input type="text" name="username" id="username" th:field="*{username}" placeholder="Username">
        </div>
        <div>
            <ul class="error-ul">
                <li th:each="err : ${#fields.errors('username')}" th:text="${err}" class="error" />
            </ul>
        </div>
        <div class="form-field d-flex align-items-center">
            <span class="fas fa-key"></span>
            <input type="password" name="password" id="password" th:field="*{password}" placeholder="Password">
        </div>
        <div>
            <ul class="error-ul">
                <li th:each="err : ${#fields.errors('password')}" th:text="${err}" class="error" />
            </ul>
        </div>
        <div class="row">
            <div class="col-4">
                <img th:src="*{'data:realCaptcha/jpg;base64,'+realCaptcha}">
            </div>
        </div>
        <div>
            <span class="fas fa-key">ENTER CAPTCHA</span>
        </div>
        <div class="form-field d-flex align-items-center">
            <span class="fas fa-key"></span>
            <input type="hidden" th:field="*{hiddenCaptcha}"/>
            <input type="text" th:field="*{captcha}" class="form-control"/>
        </div>
        <div th:if="${captchaMessage!=null}" class="card-footer bg-info text-white">
            <span class="alert alert-danger" th:text="${captchaMessage}"></span>
        </div>
        <button class="btn mt-3" type="submit" id="button-login">Login</button>
    </form>
    <div class="text-center fs-6">
        <a href="#">Forget password?</a> or <a href="#">Sign up</a>
    </div>
</div>

<script type="text/javascript" th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script>
    $(document).ready(function (){
        $('#button-login').on('click',function (){
            var pwd = $("#password").val();
            var pwdCrypto = btoa(pwd);
            console.log(pwdCrypto);
            $("#password").val(pwdCrypto);
            $("#form-login").submit();
        });
    });
</script>
</body>
</html>